// Este é o seu arquivo de schema do Prisma,
// saiba mais em: https://pris.ly/d/prisma-schema

generator client {
  provider = "python"
}

datasource db {
  provider = "postgresql"
}

// Modelo User - Armazena informações de usuário sincronizadas do Janus IDP
model User {
  id        String   @id // UUID do Janus IDP (sincronização manual)
  email     String   @unique
  createdAt DateTime @default(now())

  // Relações
  sessionAnalyses SessionAnalysis[]

  @@map("users")
}

// Modelo SessionAnalysis - Armazena resultados de análise de sessão
model SessionAnalysis {
  id             String   @id @default(uuid()) // UUID
  sessionUuid    String   @unique // Identificador único de sessão
  userId         String   // Chave estrangeira para User

  // Campos JSON para dados de análise
  narrative      Json?
  psychometrics  Json?
  intentAnalysis Json?
  insights       Json?

  // Timestamps
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  // Relações
  user           User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("session_analyses")
  @@index([userId])
  @@index([sessionUuid])
}
